<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<title>EPL Odds Checker</title>
<style>
  body {
    color:#E2E8F0;
    background:#0F1621;
    padding:24px;
    font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  .fixture-card {
    background:#111827;
    border:1px solid #1F2937;
    border-radius:14px;
    padding:14px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    text-decoration:none;
    color:inherit;
  }
  .grid {
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
    gap:12px;
    margin-bottom:24px;
  }
</style>
</head>

<body>
<h1 style="margin:0 0 6px 0;">EPL Odds Checker</h1>
<p id="updated" style="opacity:0.8;margin:0 0 16px 0;">Loading fixtures...</p>

<div id="content"></div>

<script>
// Automatically list all fixtures in the folder
async function loadFixtures() {
    const res = await fetch("./");
    const text = await res.text();

    // Parse directory listing returned by GitHub Pages
    const parser = new DOMParser();
    const doc = parser.parseFromString(text, "text/html");
    const links = [...doc.querySelectorAll("a")]
      .map(a => a.getAttribute("href"))
      .filter(href => href.endsWith(".html") && href !== "index.html");

    if (links.length === 0) {
        document.getElementById("content").innerHTML = "<p>No fixtures found.</p>";
        return;
    }

    // Extract date + teams from filename: YYYY-MM-DD-team-vs-team.html
    const fixtures = links.map(file => {
        const name = file.replace(".html", "");
        const [date, ...teams] = name.split("-");
        const dateStr = date;
        const teamA = teams.slice(0, teams.indexOf("vs")).join(" ");
        const teamB = teams.slice(teams.indexOf("vs") + 1).join(" ");
        return { file, date: dateStr, teamA, teamB };
    });

    // Group by date
    const byDate = {};
    fixtures.forEach(f => {
        if (!byDate[f.date]) byDate[f.date] = [];
        byDate[f.date].push(f);
    });

    const content = document.getElementById("content");
    content.innerHTML = "";

    Object.keys(byDate).sort().forEach(date => {
        const group = byDate[date];

        const h2 = document.createElement("h2");
        h2.textContent = date;
        h2.style.margin = "18px 0 10px 0";
        content.appendChild(h2);

        const grid = document.createElement("div");
        grid.className = "grid";

        group.forEach(f => {
            const card = document.createElement("a");
            card.href = f.file;
            card.className = "fixture-card";
            card.innerHTML = `
              <div>
                <div style="font-weight:600">${f.teamA}</div>
                <div style="opacity:0.85">vs</div>
                <div style="font-weight:600">${f.teamB}</div>
              </div>
              <div style="opacity:0.85;white-space:nowrap;">Match</div>
            `;
            grid.appendChild(card);
        });

        content.appendChild(grid);
    });

    // Update timestamp
    const now = new Date().toISOString();
    document.getElementById("updated").textContent =
      "Click a fixture to view odds. Updated: " + now;
}

loadFixtures();
</script>

</body>
</html>
